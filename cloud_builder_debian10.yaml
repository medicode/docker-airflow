timeout: 3600s
steps:
- id: airflow-bridge
  name: 'gcr.io/cloud-builders/docker'
  args: ["build", "-t", "us.gcr.io/$PROJECT_ID/docker-airflow-bridge:debian10", "-t", "us.gcr.io/$PROJECT_ID/docker-airflow-bridge:latest", "."]
  dir: debian10/airflow_bridge/
  waitFor: ['-']

- id: airflow-bridge-test
  name: 'gcr.io/cloud-builders/docker'
  args: ["build", "-t", "us.gcr.io/$PROJECT_ID/docker-airflow-bridge-test:debian10",  "-t", "us.gcr.io/$PROJECT_ID/docker-airflow-bridge-test:latest", "."]
  dir: debian10/airflow_bridge_test/
  waitFor:
    - airflow-bridge

- id: airflow-two
  name: 'gcr.io/cloud-builders/docker'
  args: ["build", "-t", "us.gcr.io/$PROJECT_ID/docker-airflow-two:debian10", "-t", "us.gcr.io/$PROJECT_ID/docker-airflow-two:latest", "."]
  dir: debian10/airflow_two/
  waitFor: ['-']

- id: airflow-two-test
  name: 'gcr.io/cloud-builders/docker'
  args: ["build", "-t", "us.gcr.io/$PROJECT_ID/docker-airflow-two-test:debian10", "-t", "us.gcr.io/$PROJECT_ID/docker-airflow-two-test:latest", "."]
  dir: debian10/airflow_two_test/
  waitFor:
    - airflow-two

logsBucket: fathom-containers-cloud-build-logs-36tugmiz

images:
  - us.gcr.io/$PROJECT_ID/docker-airflow-bridge
  - us.gcr.io/$PROJECT_ID/docker-airflow-bridge-test
  - us.gcr.io/$PROJECT_ID/docker-airflow-two
  - us.gcr.io/$PROJECT_ID/docker-airflow-two-test
